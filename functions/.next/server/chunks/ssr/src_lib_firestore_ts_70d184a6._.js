module.exports=[77929,a=>{"use strict";var b=a.i(20237);a.i(69387);var c=a.i(60574);let d={saveUserProfile:async(a,d)=>{try{if(!a)return console.error("saveUserProfile: Missing userId"),!1;let e=(0,c.doc)(b.db,"users",a);return await (0,c.setDoc)(e,{...d,updatedAt:c.Timestamp.now()},{merge:!0}),!0}catch(a){return console.error("Error saving profile:",a),!1}},getUserProfile:async a=>{try{let d=(0,c.doc)(b.db,"users",a),e=await (0,c.getDoc)(d);if(e.exists())return{id:e.id,...e.data()};return null}catch(a){return console.error("Error fetching profile:",a),null}},getAllUsers:async()=>{try{let a=(0,c.query)((0,c.collection)(b.db,"users"),(0,c.limit)(50));return(await (0,c.getDocs)(a)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error fetching all users:",a),[]}},getUserByReferralCode:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"users"),(0,c.where)("referralCode","==",a.toUpperCase()),(0,c.limit)(1)),e=await (0,c.getDocs)(d);if(!e.empty){let a=e.docs[0];return{id:a.id,...a.data()}}return null}catch(a){return console.error("Error fetching referrer:",a),null}},updateWallet:async(a,d,e)=>{try{let f=(0,c.doc)(b.db,"users",a),g={amount:d,type:d>0?"credit":"debit",description:e,date:new Date().toISOString()};return await (0,c.updateDoc)(f,{walletBalance:(0,c.increment)(d),walletHistory:(0,c.arrayUnion)(g)}),!0}catch(a){return console.error("Error updating wallet:",a),!1}},saveNiche:async(a,e)=>{try{return await (0,c.addDoc)((0,c.collection)(b.db,"users",a,"niches"),{...e,createdAt:c.Timestamp.now()}),e.name&&await d.saveUserProfile(a,{onboarding:{interests:[e.name]}}),!0}catch(a){return console.error("Error saving niche:",a),!1}},checkNameUnique:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"globalUsedChannelNames"),(0,c.where)("name","==",a.toLowerCase()));return(await (0,c.getDocs)(d)).empty}catch(a){return console.error("Error checking name:",a),!0}},lockChannelName:async(a,d)=>{try{return await (0,c.addDoc)((0,c.collection)(b.db,"globalUsedChannelNames"),{name:d.toLowerCase(),usedBy:a,createdAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error locking name:",a),!1}},logEarnings:async(a,d,e)=>{try{await (0,c.addDoc)((0,c.collection)(b.db,"users",a,"earningsHistory"),{amount:d,source:e,date:new Date().toISOString()});let f=(0,c.doc)(b.db,"users",a);return await (0,c.setDoc)(f,{earnings:{total:(0,c.increment)(d)}},{merge:!0}),!0}catch(a){return console.error("Error logging earnings:",a),!1}},saveSavedItem:async(a,d)=>{try{return await (0,c.addDoc)((0,c.collection)(b.db,"users",a,"savedItems"),{...d,savedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error saving item:",a),!1}},deleteSavedItem:async(a,d)=>{try{let e=(0,c.doc)(b.db,"users",a,"savedItems",d);return await (0,c.deleteDoc)(e),!0}catch(a){return console.error("Error deleting saved item:",a),!1}},updateUserSubscription:async(a,d,e="active")=>{try{let f=(0,c.doc)(b.db,"users",a);return await (0,c.updateDoc)(f,{plan:d,subscriptionStatus:e,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error updating subscription:",a),!1}},getSavedItems:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"users",a,"savedItems"));return(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error fetching saved items:",a),[]}},getTrends:async()=>{let a=(0,c.query)((0,c.collection)(b.db,"trends"));return(await (0,c.getDocs)(a)).docs.map(a=>({id:a.id,...a.data()}))},addTrend:async a=>{let d=(0,c.collection)(b.db,"trends");await (0,c.addDoc)(d,{...a,timestamp:c.Timestamp.now()})},getChannels:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"users",a,"channels"));return(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error fetching channels:",a),[]}},addChannel:async(a,d)=>{try{return await (0,c.addDoc)((0,c.collection)(b.db,"users",a,"channels"),{...d,createdAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error adding channel:",a),!1}},getChannel:async(a,d)=>{try{let e=(0,c.doc)(b.db,"users",a,"channels",d),f=await (0,c.getDoc)(e);if(f.exists())return{id:f.id,...f.data()};return null}catch(a){return console.error("Error fetching channel:",a),null}},updateChannel:async(a,d,e)=>{try{let f=(0,c.doc)(b.db,"users",a,"channels",d);return await (0,c.updateDoc)(f,{...e,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error updating channel:",a),!1}},deleteChannel:async(a,d)=>{try{let e=(0,c.doc)(b.db,"users",a,"channels",d);return await (0,c.updateDoc)(e,{status:"deleted",deletedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error deleting channel:",a),!1}},getTools:async(a=!1)=>{try{let d;return d=a?(0,c.query)((0,c.collection)(b.db,"tools"),(0,c.where)("isPublic","==",!0)):(0,c.query)((0,c.collection)(b.db,"tools")),(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()})).filter(a=>!0!==a.deleted)}catch(a){return console.error("Error getting tools:",a),[]}},getTool:async a=>{try{let d=(0,c.doc)(b.db,"tools",a),e=await (0,c.getDoc)(d);if(e.exists())return{id:e.id,...e.data()};return null}catch(a){return console.error("Error fetching tool:",a),null}},createTool:async a=>{try{return(await (0,c.addDoc)((0,c.collection)(b.db,"tools"),{...a,deleted:!1,createdAt:c.Timestamp.now(),updatedAt:c.Timestamp.now()})).id}catch(a){throw console.error("Error creating tool:",a),a}},updateTool:async(a,d)=>{try{let e=(0,c.doc)(b.db,"tools",a);return await (0,c.updateDoc)(e,{...d,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error updating tool:",a),!1}},deleteTool:async a=>{try{let d=(0,c.doc)(b.db,"tools",a);return await (0,c.updateDoc)(d,{deleted:!0,deletedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error deleting tool:",a),!1}},toggleToolLock:async(a,d,e)=>{try{let f=(0,c.doc)(b.db,"tools",a);return await (0,c.updateDoc)(f,{locked:d,lockReason:e||"",updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error toggling tool lock:",a),!1}},batchDeleteTools:async a=>{try{let d=(0,c.writeBatch)(b.db);return a.forEach(a=>{let e=(0,c.doc)(b.db,"tools",a);d.update(e,{deleted:!0,deletedAt:c.Timestamp.now()})}),await d.commit(),!0}catch(a){return console.error("Error batch deleting tools:",a),!1}},getGuides:async(a=!1)=>{try{let d;return d=a?(0,c.query)((0,c.collection)(b.db,"guides"),(0,c.where)("isPublic","==",!0)):(0,c.query)((0,c.collection)(b.db,"guides")),(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()})).filter(a=>!0!==a.deleted)}catch(a){return console.error("Error fetching guides:",a),[]}},getGuide:async a=>{try{let d=(0,c.doc)(b.db,"guides",a),e=await (0,c.getDoc)(d);if(e.exists())return{id:e.id,...e.data()};return null}catch(a){return console.error("Error fetching guide:",a),null}},submitContactMessage:async a=>{try{return await (0,c.addDoc)((0,c.collection)(b.db,"contact_messages"),{...a,createdAt:c.Timestamp.now(),status:"new"}),!0}catch(a){return console.error("Error submitting contact message:",a),!1}},createGuide:async a=>{try{return(await (0,c.addDoc)((0,c.collection)(b.db,"guides"),{...a,deleted:!1,createdAt:c.Timestamp.now(),updatedAt:c.Timestamp.now()})).id}catch(a){throw console.error("Error creating guide:",a),a}},updateGuide:async(a,d)=>{try{let e=(0,c.doc)(b.db,"guides",a);return await (0,c.updateDoc)(e,{...d,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error updating guide:",a),!1}},deleteGuide:async a=>{try{let d=(0,c.doc)(b.db,"guides",a);return await (0,c.updateDoc)(d,{deleted:!0,deletedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error deleting guide:",a),!1}},rateGuide:async(a,d,e,f)=>{try{let g=(0,c.doc)(b.db,"guides",a),h=await (0,c.getDoc)(g);if(!h.exists())return!1;let i=h.data(),j=(i.ratingSum||0)+d,k=(i.ratingCount||0)+1;return await (0,c.updateDoc)(g,{ratingSum:j,ratingCount:k,averageRating:Number((j/k).toFixed(1)),updatedAt:c.Timestamp.now()}),e&&f&&await (0,c.addDoc)((0,c.collection)(b.db,"users",e,"savedItems"),{type:"rated_guide",rating:d,data:f,savedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error rating guide:",a),!1}},toggleGuidePremium:async(a,d)=>{try{let e=(0,c.doc)(b.db,"guides",a);return await (0,c.updateDoc)(e,{premium:d,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error toggling guide premium:",a),!1}},batchDeleteGuides:async a=>{try{let d=(0,c.writeBatch)(b.db);return a.forEach(a=>{let e=(0,c.doc)(b.db,"guides",a);d.update(e,{deleted:!0,deletedAt:c.Timestamp.now()})}),await d.commit(),!0}catch(a){return console.error("Error batch deleting guides:",a),!1}},getCoupons:async()=>{try{let a=(0,c.query)((0,c.collection)(b.db,"coupons"));return(await (0,c.getDocs)(a)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error fetching coupons:",a),[]}},createCoupon:async a=>{try{return await (0,c.addDoc)((0,c.collection)(b.db,"coupons"),{...a,createdAt:c.Timestamp.now(),usageCount:0}),!0}catch(a){return console.error("Error creating coupon:",a),!1}},deleteCoupon:async a=>{try{return await (0,c.deleteDoc)((0,c.doc)(b.db,"coupons",a)),!0}catch(a){return console.error("Error deleting coupon:",a),!1}},toggleCouponStatus:async(a,d)=>{try{return await (0,c.updateDoc)((0,c.doc)(b.db,"coupons",a),{active:d}),!0}catch(a){return console.error("Error toggling coupon:",a),!1}},incrementCouponUsage:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"coupons"),(0,c.where)("code","==",a)),e=await (0,c.getDocs)(d);if(!e.empty){let a=e.docs[0].ref;await (0,c.updateDoc)(a,{usageCount:(0,c.increment)(1)})}}catch(a){console.error("Error incrementing coupon:",a)}},getCouponByCode:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"coupons"),(0,c.where)("code","==",a),(0,c.limit)(1)),e=await (0,c.getDocs)(d);if(!e.empty)return{id:e.docs[0].id,...e.docs[0].data()};return null}catch(a){return console.error("Error fetching coupon by code:",a),null}},getAdminStats:async()=>{try{let a=(await (0,c.getDocs)((0,c.collection)(b.db,"users"))).docs.map(a=>a.data()),d=a.length,e=a.filter(a=>"pro"===a.plan||"pro_plus"===a.plan).length,f=a.reduce((a,b)=>"pro"===b.plan?a+259:"pro_plus"===b.plan?a+599:a,0);return{totalUsers:d,activeSubs:e,revenue:f,contentGen:0}}catch(a){return console.error("Error getting admin stats:",a),{totalUsers:0,activeSubs:0,revenue:0,contentGen:0}}},getHelpArticles:async()=>{try{return(await (0,c.getDocs)((0,c.collection)(b.db,"helpArticles"))).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error getting help articles:",a),[]}},getHelpArticle:async a=>{try{let d=(0,c.doc)(b.db,"helpArticles",a),e=await (0,c.getDoc)(d);if(e.exists())return{id:e.id,...e.data()};return null}catch(a){return console.error("Error getting help article:",a),null}},createHelpArticle:async a=>{try{return(await (0,c.addDoc)((0,c.collection)(b.db,"helpArticles"),{...a,views:0,helpful:0,notHelpful:0,createdAt:c.Timestamp.now(),updatedAt:c.Timestamp.now()})).id}catch(a){return console.error("Error creating help article:",a),null}},updateHelpArticle:async(a,d)=>{try{let e=(0,c.doc)(b.db,"helpArticles",a);return await (0,c.updateDoc)(e,{...d,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error updating help article:",a),!1}},deleteHelpArticle:async a=>{try{let d=(0,c.doc)(b.db,"helpArticles",a);return await (0,c.deleteDoc)(d),!0}catch(a){return console.error("Error deleting help article:",a),!1}},incrementHelpfulCount:async(a,d)=>{try{let e=(0,c.doc)(b.db,"helpArticles",a);return await (0,c.updateDoc)(e,{[d]:(0,c.increment)(1)}),!0}catch(a){return console.error("Error incrementing helpful count:",a),!1}},getBlogs:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"blogs"));return a?.category&&(d=(0,c.query)(d,(0,c.where)("category","==",a.category))),a?.published!==void 0&&(d=(0,c.query)(d,(0,c.where)("published","==",a.published))),(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error getting blogs:",a),[]}},getBlogBySlug:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"blogs"),(0,c.where)("slug","==",a),(0,c.limit)(1)),e=await (0,c.getDocs)(d);if(!e.empty){let a=e.docs[0];return{id:a.id,...a.data()}}return null}catch(a){return console.error("Error getting blog by slug:",a),null}},getBlog:async a=>{try{let d=(0,c.doc)(b.db,"blogs",a),e=await (0,c.getDoc)(d);if(e.exists())return{id:e.id,...e.data()};return null}catch(a){return console.error("Error getting blog:",a),null}},createBlog:async a=>{try{return(await (0,c.addDoc)((0,c.collection)(b.db,"blogs"),{...a,views:0,createdAt:c.Timestamp.now(),updatedAt:c.Timestamp.now(),publishedAt:a.published?c.Timestamp.now():null})).id}catch(a){return console.error("Error creating blog:",a),null}},updateBlog:async(a,d)=>{try{let e=(0,c.doc)(b.db,"blogs",a);return await (0,c.updateDoc)(e,{...d,updatedAt:c.Timestamp.now()}),!0}catch(a){return console.error("Error updating blog:",a),!1}},deleteBlog:async a=>{try{let d=(0,c.doc)(b.db,"blogs",a);return await (0,c.deleteDoc)(d),!0}catch(a){return console.error("Error deleting blog:",a),!1}},batchDeleteBlogs:async a=>{try{let d=(0,c.writeBatch)(b.db);return a.forEach(a=>{d.delete((0,c.doc)(b.db,"blogs",a))}),await d.commit(),!0}catch(a){return console.error("Error batch deleting blogs:",a),!1}},incrementBlogViews:async a=>{try{let d=(0,c.doc)(b.db,"blogs",a);return await (0,c.updateDoc)(d,{views:(0,c.increment)(1)}),!0}catch(a){return console.error("Error incrementing blog views:",a),!1}},bulkImportBlogs:async a=>{let d=0,e=0;for(let f of a)try{await (0,c.addDoc)((0,c.collection)(b.db,"blogs"),{...f,views:0,createdAt:c.Timestamp.now(),updatedAt:c.Timestamp.now(),publishedAt:f.published?c.Timestamp.now():null}),d++}catch(a){console.error("Error importing blog:",a),e++}return{success:d,failed:e}},saveContentHistory:async(a,d)=>{try{return(await (0,c.addDoc)((0,c.collection)(b.db,"users",a,"content_history"),{...d,createdAt:c.Timestamp.now()})).id}catch(a){return console.error("Error saving content history:",a),null}},getContentHistory:async(a,d)=>{try{let e=(0,c.query)((0,c.collection)(b.db,"users",a,"content_history")),f=(await (0,c.getDocs)(e)).docs.map(a=>({id:a.id,...a.data()}));return f.sort((a,b)=>{let c=a.createdAt&&"function"==typeof a.createdAt.toMillis?a.createdAt.toMillis():0;return(b.createdAt&&"function"==typeof b.createdAt.toMillis?b.createdAt.toMillis():0)-c}),d&&(d.type&&"all"!==d.type&&(f=f.filter(a=>a.type===d.type)),d.platform&&"all"!==d.platform&&(f=f.filter(a=>a.platform===d.platform)),d.startDate&&(f=f.filter(a=>(a.createdAt&&"function"==typeof a.createdAt.toDate?a.createdAt.toDate():new Date)>=d.startDate)),d.endDate&&(f=f.filter(a=>(a.createdAt&&"function"==typeof a.createdAt.toDate?a.createdAt.toDate():new Date)<=d.endDate))),f}catch(a){return console.error("Error fetching content history:",a),[]}},trackBlogView:async a=>{try{let d=(0,c.doc)(b.db,"blogs",a);await (0,c.updateDoc)(d,{views:(0,c.increment)(1)})}catch(a){console.error("Error tracking view:",a)}},toggleBlogLike:async(a,d)=>{try{let e=(0,c.doc)(b.db,"blogs",a),f=(0,c.doc)(b.db,"users",d,"liked_blogs",a);if((await (0,c.getDoc)(f)).exists())return await (0,c.deleteDoc)(f),await (0,c.updateDoc)(e,{likes:(0,c.increment)(-1)}),!1;return await (0,c.setDoc)(f,{likedAt:(0,c.serverTimestamp)()}),await (0,c.updateDoc)(e,{likes:(0,c.increment)(1)}),!0}catch(a){return console.error("Error toggling like:",a),!1}},toggleSaveBlog:async(a,d)=>{try{let e=(0,c.query)((0,c.collection)(b.db,"users",d,"savedItems"),(0,c.where)("type","==","blog"),(0,c.where)("data.id","==",a)),f=await (0,c.getDocs)(e);if(!f.empty)return await (0,c.deleteDoc)((0,c.doc)(b.db,"users",d,"savedItems",f.docs[0].id)),!1;{let e=(0,c.doc)(b.db,"blogs",a),f=await (0,c.getDoc)(e);if(!f.exists())return!1;return await (0,c.addDoc)((0,c.collection)(b.db,"users",d,"savedItems"),{userId:d,type:"blog",data:{id:f.id,...f.data()},savedAt:(0,c.serverTimestamp)()}),!0}}catch(a){return console.error("Error toggling save:",a),!1}},getUsedBlogs:async a=>{try{let d=[],e=[];for(let e of(await (0,c.getDocs)((0,c.collection)(b.db,"users",a,"liked_blogs"))).docs.map(a=>a.id)){let a=await (0,c.getDoc)((0,c.doc)(b.db,"blogs",e));a.exists()&&d.push({id:a.id,...a.data()})}let f=(0,c.query)((0,c.collectionGroup)(b.db,"comments"),(0,c.where)("userId","==",a)),g=await (0,c.getDocs)(f),h=new Set;for(let a of(g.forEach(a=>h.add(a.data().blogId)),Array.from(h))){let d=await (0,c.getDoc)((0,c.doc)(b.db,"blogs",a));d.exists()&&e.push({id:d.id,...d.data()})}return{liked:d,commented:e}}catch(a){return console.error("Error fetching used blogs:",a),{liked:[],commented:[]}}},isBlogLiked:async(a,d)=>{try{let e=(0,c.doc)(b.db,"users",d,"liked_blogs",a);return(await (0,c.getDoc)(e)).exists()}catch(a){return!1}},isBlogSaved:async(a,d)=>{try{let e=(0,c.query)((0,c.collection)(b.db,"users",d,"savedItems"),(0,c.where)("type","==","blog"),(0,c.where)("data.id","==",a));return!(await (0,c.getDocs)(e)).empty}catch(a){return!1}},addComment:async(a,d,e,f)=>{try{let g={blogId:a,userId:d,userName:f.name,userAvatar:f.avatar||null,content:e,createdAt:(0,c.serverTimestamp)()};await (0,c.addDoc)((0,c.collection)(b.db,"blogs",a,"comments"),g);let h=(0,c.doc)(b.db,"blogs",a);return await (0,c.updateDoc)(h,{commentsCount:(0,c.increment)(1)}),!0}catch(a){return console.error("Error adding comment:",a),!1}},getComments:async a=>{try{let d=(0,c.query)((0,c.collection)(b.db,"blogs",a,"comments"),(0,c.orderBy)("createdAt","desc"));return(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){return console.error("Error getting comments:",a),[]}},deleteComment:async(a,d)=>{try{await (0,c.deleteDoc)((0,c.doc)(b.db,"blogs",a,"comments",d));let e=(0,c.doc)(b.db,"blogs",a);return await (0,c.updateDoc)(e,{commentsCount:(0,c.increment)(-1)}),!0}catch(a){return console.error("Error deleting comment:",a),!1}}};a.s(["dbService",0,d])}];

//# sourceMappingURL=src_lib_firestore_ts_70d184a6._.js.map